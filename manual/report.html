<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />

    <title>Spring 2022 | JLox Interpreter Project</title>

    <link href="./report.css" rel="stylesheet" />
    <script async src="/cdn-cgi/bm/cv/669835187/api.js"></script>
  </head>
  <body>
    <div class="container">
      <div class="section center">
        <h2 class="no-bottom-margin">JLox Interpreter</h2>
        <h3 class="no-margin">Spring 2022 â€¢ CS 403</h3>
        <p class="no-top-margin">Language used: C#</p>
      </div>
      <div class="tabs row">
        <div class="col s12 m4 tab active" data-tab="part1">
          <a href='javascript:tabSelect("part1")'>
            Part 1<br />Implementation
          </a>
        </div>
        <div class="col s12 m4 tab" data-tab="part2">
          <a href='javascript:tabSelect("part2")'> Part 2<br />Testing </a>
        </div>
        <div class="col s12 m4 tab" data-tab="part3">
          <a href='javascript:tabSelect("part3")'>
            Part 3<br />Compilation and Running Tests
          </a>
        </div>
      </div>
      <div class="tab-content-area">
        <!-- Implementation -->
        <div id="part1">
          <div class="section">
            <h4>Members</h4>
            <table class="center">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>CWID</th>
                  <th>Email Address</th>
                  <th>Time Spent</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Cara Cannarozzi</td>
                  <td style="font-family: monospace">11970792</td>
                  <td>
                    <a href="mailto:cacannarozzi@crimson.ua.edu"
                      >cacannarozzi@crimson.ua.edu</a
                    >
                  </td>
                  <!-- UPDATE TIME TRACKING HERE -->
                  <td>13 hours</td>
                </tr>
                <tr>
                  <td>Madeline Moore</td>
                  <td style="font-family: monospace">11884126</td>
                  <td>
                    <a href="mailto:mcmoore11@crimson.ua.edu"
                      >mcmoore11@crimson.ua.edu</a
                    >
                  </td>
                  <!-- UPDATE TIME TRACKING HERE -->
                  <td>13 hours</td>
                </tr>
                <tr>
                  <td>Peter Zhang</td>
                  <td style="font-family: monospace">11861641</td>
                  <td>
                    <a href="mailto:pwzhang@crimson.ua.edu"
                      >pwzhang@crimson.ua.edu</a
                    >
                  </td>
                  <!-- UPDATE TIME TRACKING HERE -->
                  <td>10 hours</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="divider"></div>
          <div class="section">
            <h4>Implementation Task Distribution</h4>
            <table>
              <thead>
                <tr>
                  <th>Task</th>
                  <th colspan="3">Percentage of Task</th>
                </tr>
                <tr>
                  <th></th>
                  <th>Cara Cannarozzi</th>
                  <th>Madeline Moore</th>
                  <th>Peter Zhang</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <strong>Research/Learning</strong>
                  </td>

                  <td>33.33%</td>
                  <td>33.33%</td>
                  <td>33.33%</td>
                </tr>
                <tr>
                  <td>
                    <strong>Design</strong>
                  </td>

                  <td>33.33%</td>
                  <td>33.33%</td>
                  <td>33.33%</td>
                </tr>
                <tr>
                  <td>
                    <strong>Implementation of Code</strong>
                  </td>

                  <td>35.00%</td>
                  <td>35.00%</td>
                  <td>30.00%</td>
                </tr>
              </tbody>
            </table>
            <p></p>
          </div>
          <div class="divider"></div>

          <div class="section">
            <h4>Research/Learning</h4>
            <p>
              Since we already read most of the book,
              <a href="https://craftinginterpreters.com/contents.html"
                >Crafting interpreters</a
              >, together for project one, we were already familiar with the
              language. Throughout the development of our version of the Lox
              interpreter we heavily referenced the book. We chose to use the C#
              language to implement our version of Lox since it is similar to
              Java. Even though they are similar, there are still quite a few
              differences. We had to research C# in order to implement our
              version of Lox. Thankfully there are plenty of resources to help
              with this. We used Microsoft's C# documentation and also a table
              from Tangible Software Solutions that had common C# and Java
              equivalents. The documentation for C# can be found
              <a href="https://docs.microsoft.com/en-us/dotnet/csharp/">here</a>
              and the table can be found
              <a
                href="https://www.tangiblesoftwaresolutions.com/java-and-csharp-equivalents.html"
                >here</a
              >. After learning about C# we were ready to begin creating our
              interpreter.
            </p>
            <h4>Design</h4>
            <p>
              Although C# and Java were similar languages, there were still
              quite a few differences, and some of these caused us to have to
              make some selective design choices, such as:
              <ul>
                <li>Following 
                  <a href="https://docs.microsoft.com/en-us/dotnet/csharp/fundamentals/coding-style/coding-conventions"
                  >C#'s naming convention</a> with some of our own changes. such as using PascalCasing when
                   naming a class or struct, beginning interface names with "I," using
                   implicit typing for local variables when possible, capitalizing method names, 
                   and using try-catch for most exception handling.</li>
                <li>Using a List in place of a Stack to implement scopes to resolve statements</li>
                <li>Using a Dictionary in place of a HashMap</li> 
                <li>Using "readonly" for immutable variables in place of "final"</li>
                <li>Using namespaces in place of packages</li>
                <li>Using "foreach" loops</li>
              </ul>  
            </p>
            <h4>Implementation of Code</h4>
            <p>
              To implement this code, we met as a group many times until the
              project was complete. We used a pair programming approach by having one 
              group member broadcast their screen onto a TV in a group study room in Gorgas. 
              We implemented the interpreter in the same order that Crafting Interpreters 
              implements jlox. This provided us with a recipe for the interpreter and a more 
              detailed guide to the lox language. We used Rider as our IDE because it's more 
              compatible with C#. Furthermore, we used Rider's debugger as our main tool to fix our project, 
              since it provided a detailed stack trace that's capable of showing the value of 
              every variable during every step of the project's execution. This was especially 
              helpful when fixing our Environment class, since we could see the exact contents 
              of an environment during any point of execution. Debugging dominated the total 
              time spent working on this project. The bug we spent the longest time squashing 
              was the evaluation of return statements. Our program would simply return a value 
              when evaluating a return statement, instead of jumping forward to the original 
              function call. To correct this, we used exceptions to throw the evaluated Return value 
              and catch it in the LoxFunction class where the function is originally called.
            </p>
            <p></p>
          </div>
          <p></p>
        </div>
        <!-- Testing -->
        <div id="part2" class="hide">
          <div class="section">
            <h4>Members</h4>
            <table class="center">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>CWID</th>
                  <th>Email Address</th>
                  <th>Time Spent</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Cara Cannarozzi</td>
                  <td style="font-family: monospace">11970792</td>
                  <td>
                    <a href="mailto:cacannarozzi@crimson.ua.edu"
                      >cacannarozzi@crimson.ua.edu</a
                    >
                  </td>
                  <!-- UPDATE TIME TRACKING HERE -->
                  <td>4 hours</td>
                </tr>
                <tr>
                  <td>Madeline Moore</td>
                  <td style="font-family: monospace">11884126</td>
                  <td>
                    <a href="mailto:mcmoore11@crimson.ua.edu"
                      >mcmoore11@crimson.ua.edu</a
                    >
                  </td>
                  <!-- UPDATE TIME TRACKING HERE -->
                  <td>4 hours</td>
                </tr>
                <tr>
                  <td>Peter Zhang</td>
                  <td style="font-family: monospace">11861641</td>
                  <td>
                    <a href="mailto:pwzhang@crimson.ua.edu"
                      >pwzhang@crimson.ua.edu</a
                    >
                  </td>
                  <!-- UPDATE TIME TRACKING HERE -->
                  <td>8 hours</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="divider"></div>
          <div class="section">
            <h4>Testing Task Distribution</h4>
            <table>
              <thead>
                <tr>
                  <th>Task</th>
                  <th colspan="3">Percentage of Task</th>
                </tr>
                <tr>
                  <th></th>
                  <th>Cara Cannarozzi</th>
                  <th>Madeline Moore</th>
                  <th>Peter Zhang</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <strong>Fix Tim Budd's C++ Kamin Lisp Interpreter</strong>
                  </td>

                  <td>15.00%</td>
                  <td>15.00%</td>
                  <td>70.00%</td>
                </tr>
                <tr>
                  <td>
                    <strong>Testing Script</strong>
                  </td>

                  <td>5.00%</td>
                  <td>5.00%</td>
                  <td>90.00%</td>
                </tr>

                <tr>
                  <td>
                    <strong>Test Cases</strong>
                  </td>

                  <td>40.00%</td>
                  <td>40.00%</td>
                  <td>20.00%</td>
                </tr>
              </tbody>
            </table>
            <p></p>
          </div>
          <div class="divider"></div>

          <div class="section">
            <h4>Fix Tim Budd's C++ Kamin Lisp Interpreter</h4>
            <p>
              We wanted something to compare our test outputs to. Kamin
              references Tim Budd's C++ version of the Kamin interpreters
              <a href="https://kamin.cs.illinois.edu/pubs.html">here</a> and the
              download for Tim Budd's code can be found
              <a
                href="https://www.cs.cmu.edu/afs/cs/project/ai-repository/ai/lang/lisp/impl/kamin/budd/0.html"
                >here</a
              >
              on the CMU AI repository. Since Tim Budd's C++ implementation was
              made in 1994 it did not work with a modern compiler, we had to
              manually update each file to compile. This involved renaming true
              and false, fixing imports, replacing gets with fgets, and other
              small changes. Once the program was able to compile, we used the
              program to aid our development and testing.
            </p>
          </div>
          <div class="section">
            <h4>Testing Script</h4>
            <div style="float: left">
              <p>
                We used a bash script to help automate our tests. The bash
                script is named "tester.sh" and it is located in the main
                directory. It is hardcoded to specifically work with our project
                directory. We updated a 1994 C++ version of Kamin's Lisp
                Interpreter to work with a modern day C++ compiler. The testing
                script ask to run either a specified single test case or all of
                the test cases. It will then compile Kamin's Lisp Interpreter.
                Then the tester will then run the test case(s) on the C++ Kamin
                Interpreter and our own interpreter and compare the outputs. If
                the resulting outputs are the same then the test passes.
              </p>
              <p>
                Below, to the right you can see the output of our tester when we
                ran it. To the left there is a list of our test cases. You can
                view each test case individually along with the output of our
                interpreter (the output is the same as Tim Budd's version of
                Kamin's Lisp Interpreter).
              </p>
            </div>
            <div style="float: right">
              <!-- Thanks Dr. Yessick -->
              <img id="test-case-all" src="./pictures/testerresults.png" />
            </div>
          </div>

          <div class="section">
            <h4>Test Cases</h4>
            <!-- Thanks Dr. Yessick -->
            <!-- <b>Due to some javascript craziness going back to test case 1 breaks everything, if you need to view test case 1 again please refresh the page.</b> -->
            <p style="margin-bottom: 0">Choose the test case to view:</p>
            <ul style="margin-top: 0">
              <li>
                <a
                  class="underline"
                  href="javascript:setTestCase(1)"
                  test-case="case-1"
                >
                  Test Case 1
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(2)" test-case="case-2">
                  Test Case 2
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(3)" test-case="case-3">
                  Test Case 3
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(4)" test-case="case-4">
                  Test Case 4
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(5)" test-case="case-5">
                  Test Case 5
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(6)" test-case="case-6">
                  Test Case 6
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(7)" test-case="case-7">
                  Test Case 7
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(8)" test-case="case-8">
                  Test Case 8
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(9)" test-case="case-9">
                  Test Case 9
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(10)" test-case="case-10">
                  Test Case 10
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(11)" test-case="case-11">
                  Test Case 11
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(12)" test-case="case-12">
                  Test Case 12
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(13)" test-case="case-13">
                  Test Case 13
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(14)" test-case="case-14">
                  Test Case 14
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(15)" test-case="case-15">
                  Test Case 15
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(16)" test-case="case-16">
                  Test Case 16
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(17)" test-case="case-17">
                  Test Case 17
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(18)" test-case="case-18">
                  Test Case 18
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(19)" test-case="case-19">
                  Test Case 19
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(20)" test-case="case-20">
                  Test Case 20
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(21)" test-case="case-21">
                  Test Case 21
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(22)" test-case="case-22">
                  Test Case 22
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(23)" test-case="case-23">
                  Test Case 23
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(24)" test-case="case-24">
                  Test Case 24
                </a>
              </li>
              <li>
                <a href="javascript:setTestCase(25)" test-case="case-25">
                  Test Case 25
                </a>
              </li>
            </ul>
            <div class="center" id="part3-test-case-img-container">
              <img id="test-case-1" src="./pictures/case-1.png" />
              <img class="hide" id="test-case-2" src="./pictures/case-2.png" />
              <img class="hide" id="test-case-3" src="./pictures/case-3.png" />
              <img class="hide" id="test-case-4" src="./pictures/case-4.png" />
              <img class="hide" id="test-case-5" src="./pictures/case-5.png" />
              <img class="hide" id="test-case-6" src="./pictures/case-6.png" />
              <img class="hide" id="test-case-7" src="./pictures/case-7.png" />
              <img class="hide" id="test-case-8" src="./pictures/case-8.png" />
              <img class="hide" id="test-case-9" src="./pictures/case-9.png" />
              <img
                class="hide"
                id="test-case-10"
                src="./pictures/case-10.png"
              />
              <img
                class="hide"
                id="test-case-11"
                src="./pictures/case-11.png"
              />
              <img
                class="hide"
                id="test-case-12"
                src="./pictures/case-12.png"
              />
              <img
                class="hide"
                id="test-case-13"
                src="./pictures/case-13.png"
              />
              <img
                class="hide"
                id="test-case-14"
                src="./pictures/case-14.png"
              />
              <img
                class="hide"
                id="test-case-15"
                src="./pictures/case-15.png"
              />
              <img
                class="hide"
                id="test-case-16"
                src="./pictures/case-16.png"
              />
              <img
                class="hide"
                id="test-case-17"
                src="./pictures/case-17.png"
              />
              <img
                class="hide"
                id="test-case-18"
                src="./pictures/case-18.png"
              />
              <img
                class="hide"
                id="test-case-19"
                src="./pictures/case-19.png"
              />
              <img
                class="hide"
                id="test-case-20"
                src="./pictures/case-20.png"
              />
              <img
                class="hide"
                id="test-case-21"
                src="./pictures/case-21.png"
              />
              <img
                class="hide"
                id="test-case-22"
                src="./pictures/case-22.png"
              />
              <img
                class="hide"
                id="test-case-23"
                src="./pictures/case-23.png"
              />
              <img
                class="hide"
                id="test-case-24"
                src="./pictures/case-24.png"
              />
              <img
                class="hide"
                id="test-case-25"
                src="./pictures/case-25.png"
              />

              <!-- For loading test cases live on a server.
                <div class="side-by-side">
                <strong><p id="test-case-num">Test Case 1 Input:</p></strong>
                <pre><code id="test-case-display"></code></pre>
              </div>
              <div class="side-by-side">
                <strong><p id="test-output-num">Test Case Output 1:</p></strong>
                <pre><code id="test-result-display"></code></pre>
              </div> -->
            </div>
          </div>
          <p></p>
        </div>
        <!-- Compilation + Testing -->
        <div id="part3" class="hide">
          <div class="section">
            <h4>Requirements</h4>
            <p style="margin-bottom: 0">
              This project has a few requirements. They are listed below.
            </p>
            <ul>
              <li>
                Python3 - For running the interpreter
                <ul>
                  <li>
                    You can get Python3 from this
                    <a href="https://www.python.org/downloads/"> link</a>.
                  </li>
                </ul>
              </li>
              <li>
                Bash - For running the tester
                <ul>
                  <li>
                    Bash typically comes with Linux and MacOS. If you are
                    Windows you can install Cywgin in order to run bash scripts.
                    You can find the installation page
                    <a href="https://www.cygwin.com/install.html"> here</a>.
                  </li>
                </ul>
              </li>
              <li>
                C++ - For running the tester
                <ul>
                  <li>
                    MacOS comes with a C++ compiler (Apple Clang). If you are
                    using Windows or Linux, any C++ compiler should work.
                  </li>
                </ul>
              </li>
            </ul>
          </div>
          <div class="divider"></div>
          <div class="section">
            <h4>Interpreter Modes</h4>
            <p>
              This project was made using python3. The interpreter itself is
              like Python3 since it has two modes. It can either interpret Lisp
              code from the command line or from a file. The file mode uses argv
              to read in the name of the file to interpret.
            </p>
          </div>
          <div class="section">
            <h4>Interpreting code from the command line</h4>
            <p style="margin-bottom: 0">
              To run the interpreter (reading from command line), type the
              following into the command line while in the main directory:
            </p>
            <code> $ python3 src/project1.py </code>
          </div>
          <div class="section">
            <h4>Interpreting code from a file</h4>
            <p style="margin-bottom: 0">
              To run the interpreter (reading a file), type the following into
              the command line while in the main directory:
            </p>
            <code> $ python3 src/project1.py LISPFILE.lisp </code>
            <p style="margin-top: 0">
              Where LISPFILE.lisp is the name of the file you want to read.
            </p>
          </div>
          <div class="divider"></div>
          <div class="section">
            <h4>Running the tester</h4>
            <p style="margin-bottom: 0">
              The tester is a bash script that can be run from the command line.
              You can run the tester by typing the following into the command
              line while in the main directory:
            </p>
            <code> $ bash tester.sh </code>
          </div>
          <div class="section">
            <h4>Using the tester</h4>
            <p>
              Once you have ran the tester, it will prompt you for a test case
              to run. You can either type a specific test case number or type
              "ALL" to run all test cases. The tester will run run the case(s)
              and print if the interpreter passed or failed the test case(s).
            </p>
          </div>

          <div class="divider"></div>
          <div class="section">
            <h4>Common Problems</h4>
            <p style="margin-bottom: 0">
              These are some fixes for common problems.
            </p>
            <ul>
              <li>
                If you are using a Windows machine, make sure the file line
                endings are LF and not CRLF. CRLF line endings will break the
                tester.
              </li>
            </ul>
          </div>
          <p></p>
        </div>
      </div>
    </div>
    <p></p>
  </body>
</html>
<script type="text/javascript">
  function tabSelect(tabName) {
    const newTab = document.querySelector("[data-tab=" + tabName + "]");
    const currentTab = document.querySelector(".active[data-tab]");
    newTab.classList.toggle("active");
    currentTab.classList.toggle("active");

    const currentTabContent = document.getElementById(
      currentTab.getAttribute("data-tab")
    );
    const newTabContent = document.getElementById(
      newTab.getAttribute("data-tab")
    );
    currentTabContent.classList.toggle("hide");
    newTabContent.classList.toggle("hide");
  }

  function readTextFile(file) {
    var rawFile = new XMLHttpRequest();
    rawFile.open("GET", file, false);
    rawFile.onreadystatechange = function () {
      if (rawFile.readyState === 4) {
        if (rawFile.status === 200 || rawFile.status == 0) {
          var allText = rawFile.responseText;
          return allText;
        }
      }
    };
    rawFile.send(null);
    return rawFile.responseText;
  }

  function setTestCase(num) {
    const newLi = document.querySelector("[test-case=case-" + num + "]");
    const oldLi = document.querySelector(".underline[test-case]");
    newLi.classList.toggle("underline");
    oldLi.classList.toggle("underline");

    const previousImage = document.querySelector(
      "#part3-test-case-img-container :not(.hide)"
    );
    // thanks Dr. Yessick
    if (previousImage != null) {
      previousImage.classList.toggle("hide");
    }
    previousImage.classList.toggle("hide");
    const nextImage = document.querySelector("#test-case-" + num);
    nextImage.classList.toggle("hide");
  }

  /*
  // The following can be used to load test case results live ONLY if the page is being hosted on a server.
  const testNumDisplay = document.getElementById("test-case-num");
  const testOutputNumDisplay = document.getElementById("test-output-num");
  const testDisplay = document.getElementById("test-case-display");
  const testAnsDisplay = document.getElementById("test-result-display");
  setTestCase(1);

  function setTestCase(num) {
    // handle list updating
    const newLi = document.querySelector("[test-case=case-" + num + "]");
    const oldLi = document.querySelector(".underline[test-case]");
    newLi.classList.toggle("underline");
    oldLi.classList.toggle("underline");
    // handle test case updating
    testNumDisplay.innerHTML = "Test Case " + num + ":";
    testOutputNumDisplay.innerHTML = "Test Case Output " + num + ":";
    testDisplay.innerHTML = readTextFile("../tester/tests/test" + num + ".lisp");
    testAnsDisplay.innerHTML = readTextFile(
      "../tester/tests/test" + num + ".ans"
    ).substring(1);
    if (testAnsDisplay.innerHTML[0] === "\n") {
      testAnsDisplay.innerHTML = testAnsDisplay.innerHTML.substring(1);
    }
  }
  */
</script>
